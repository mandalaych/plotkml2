<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate an object of class "SpatialPhotoOverlay" — spPhoto • plotKML</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate an object of class " spatialphotooverlay spphoto><meta property="og:description" content='spPhoto function can be used to wrap pixel map (pixmapRGB), EXIF (Exchangeable Image File format) data, spatial location information (standing point), and PhotoOverlay (geometry) parameters to create an object of class "SpatialPhotoOverlay". This object can then be parsed to KML and visualized using Google Earth.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plotKML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Envirometrix/plotKML/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate an object of class <code>"SpatialPhotoOverlay"</code></h1>
    
    <div class="hidden name"><code>spPhoto.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>spPhoto</code> function can be used to wrap pixel map (<code>pixmapRGB</code>), <a href="https://en.wikipedia.org/wiki/Exchangeable_image_file_format" class="external-link">EXIF</a> (Exchangeable Image File format) data, spatial location information (standing point), and <code>PhotoOverlay</code> (geometry) parameters to create an object of class <code>"SpatialPhotoOverlay"</code>. This object can then be parsed to KML and visualized using Google Earth.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spPhoto</span><span class="op">(</span><span class="va">filename</span>, <span class="va">obj</span>, <span class="va">pixmap</span>, exif.info <span class="op">=</span> <span class="cn">NULL</span>, ImageWidth <span class="op">=</span> <span class="fl">0</span>, </span>
<span>   ImageHeight <span class="op">=</span> <span class="fl">0</span>, bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">ImageHeight</span><span class="op">*</span><span class="va">ImageWidth</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>   bbox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">36000</span><span class="op">*</span><span class="va">ImageWidth</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">36000</span><span class="op">*</span><span class="va">ImageHeight</span><span class="op">)</span>,</span>
<span>   DateTime <span class="op">=</span> <span class="st">""</span>, ExposureTime <span class="op">=</span> <span class="st">""</span>, FocalLength <span class="op">=</span> <span class="st">"50 mm"</span>, </span>
<span>   Flash <span class="op">=</span> <span class="st">"No Flash"</span>, rotation <span class="op">=</span> <span class="fl">0</span>, leftFov <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, rightFov <span class="op">=</span> <span class="fl">30</span>, </span>
<span>   bottomFov <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, topFov <span class="op">=</span> <span class="fl">30</span>, near <span class="op">=</span> <span class="fl">50</span>, </span>
<span>   shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rectangle"</span>, <span class="st">"cylinder"</span>, <span class="st">"sphere"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, range <span class="op">=</span> <span class="fl">1000</span>, tilt <span class="op">=</span> <span class="fl">90</span>, </span>
<span>   heading <span class="op">=</span> <span class="fl">0</span>, roll <span class="op">=</span> <span class="fl">0</span>, test.filename <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>filename</dt>
<dd><p>file name with extension (ideally an URL)</p></dd>

  <dt>obj</dt>
<dd><p>object of class "SpatialPoints" (requires a single point object)</p></dd>

  <dt>pixmap</dt>
<dd><p>object of class "pixmapRGB" (see package pixmap)</p></dd>

  <dt>exif.info</dt>
<dd><p>named list containing all available <a href="https://exiftool.org/" class="external-link">EXIF</a> metadata</p></dd>

  <dt>ImageWidth</dt>
<dd><p>(optional) image width in pixels</p></dd>

  <dt>ImageHeight</dt>
<dd><p>(optional) image height in pixels</p></dd>

  <dt>bands</dt>
<dd><p>(optional) RGB bands as vectors (see <code><a href="https://rdrr.io/pkg/pixmap/man/pixmap.html" class="external-link">pixmap::pixmapRGB</a></code>)</p></dd>

  <dt>bbox</dt>
<dd><p>(optional) bounding box coordinates (by default 1 pixel is about 1 m in arc degrees)</p></dd>
  
  <dt>DateTime</dt>
<dd><p>(optional) usually available from the camera EXIF data</p></dd>

  <dt>ExposureTime</dt>
<dd><p>(optional) usually available from the camera EXIF data</p></dd>

  <dt>FocalLength</dt>
<dd><p>(optional) usually available from the camera EXIF data</p></dd>

  <dt>Flash</dt>
<dd><p>(optional) usually available from the camera EXIF data</p></dd>

  <dt>rotation</dt>
<dd><p>(optional) rotation angle in 0--90 degrees</p></dd>

  <dt>leftFov</dt>
<dd><p>(optional) angle, in degrees, between the camera's viewing direction and the left side of the view volume (-180 -- 0)</p></dd>

  <dt>rightFov</dt>
<dd><p>(optional) angle, in degrees, between the camera's viewing direction and the right side of the view volume (0 -- 180)</p></dd>

  <dt>bottomFov</dt>
<dd><p>(optional) angle, in degrees, between the camera's viewing direction and the bottom side of the view volume (-90 -- 0)</p></dd>

  <dt>topFov</dt>
<dd><p>(optional) angle, in degrees, between the camera's viewing direction and the top side of the view volume (0 -- 90)</p></dd>

  <dt>near</dt>
<dd><p>(optional) measurement in meters along the viewing direction from the camera viewpoint to the PhotoOverlay shape</p></dd>

  <dt>shape</dt>
<dd><p>(optional) shape type --- rectangle (standard photograph), cylinder (for panoramas), or sphere (for spherical panoramas)</p></dd>

  <dt>range</dt>
<dd><p>(optional) distance from the camera to the placemark</p></dd>

  <dt>tilt</dt>
<dd><p>(optional) rotation, in degrees, of the camera around the X axis</p></dd>

  <dt>heading</dt>
<dd><p>(optional) direction (azimuth) of the camera, in degrees (0 -- 360)</p></dd>

  <dt>roll</dt>
<dd><p>(optional) rotation about the y axis, in degrees (0 -- 180)</p></dd>

  <dt>test.filename</dt>
<dd><p>logical; species whether a test should be first performed that the file name really exists (recommended)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns an object of class <code>"SpatialPhotoOverlay"</code>:</p>
<dl><dt>filename</dt>
<dd><p>URL location of the original image</p></dd>

<dt>pixmap</dt>
<dd><p>optional; local copy of the image (<code>"pixmapRGB"</code> class)</p></dd>

<dt>exif.info</dt>
<dd><p>list of EXIF metadata</p></dd>

<dt>PhotoOverlay</dt>
<dd><p>list of the camera geometry parameters (KML specifications)</p></dd>

<dt>sp</dt>
<dd><p>location of the camera (<code>"SpatialPoints"</code> class)</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The most effective way to import a field photograph to <code>SpatialPhotoOverlay</code> for parsing to KML is to: (<strong>a</strong>) use the <a href="https://exiftool.org/" class="external-link">EXIF tool</a> (courtesy of Phil Harvey) to add any important tags in the image file, (<strong>b</strong>) once you've added all important tags, you can upload your image either to a local installation of Mediawiki or to a public portal such as the <a href="https://commons.wikimedia.org/wiki/Special:UploadWizard" class="external-link">Wikimedia Commons</a>, (<strong>c</strong>) enter the missing information if necessary and add an image description. Once the image is on the server, you only need to record its unique name and then read all metadata from the Wikimedia server following the examples below.<br> 
You can also consider importing images to R by using the <code>pixmap</code> package, and reading the technical information via e.g. the <a href="https://cran.r-project.org/package=exif" class="external-link"><code>exif</code></a> package. If the image is taken using a GPS enabled camera, by getting the EXIF metadata you can generate the complete <code>SpatialPhotoOverlay</code> object with minimum user interaction. Otherwise, you need to at least specify: creation date, file name, and location of the focal point of the camera (e.g. by creating <code>"SpatialPoints"</code> object).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <code>spPhoto</code> function will try to automatically fix the aspect ratio of the <code>ViewVolume</code> settings (<code>leftFov</code>, <code>rightFov</code>, <code>bottomFov</code>, <code>topFov</code>), and based on the original aspect ratio as specified in the EXIF data. This might not work for all images, in which case you will have to manually adjust those parameters.<br>
Dimension of <code>3/36000*ImageWidth</code> in decimal degrees is about 10 m in nature (3-arc seconds is about 100 m, depending on the latitude).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>EXIF tool (<a href="https://exiftool.org/" class="external-link">https://exiftool.org/</a>)</p></li>
<li><p>Wikimedia API (<a href="https://www.mediawiki.org/wiki/API" class="external-link">https://www.mediawiki.org/wiki/API</a>)</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Tomislav Hengl</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getWikimedia.html">getWikiMedia.ImageInfo</a></code>, <code><a href="https://rdrr.io/pkg/pixmap/man/pixmap.html" class="external-link">pixmap::pixmapRGB</a></code>, <code><a href="spMetadata.html">spMetadata</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># two examples with images on Wikimedia Commons</span></span></span>
<span class="r-in"><span><span class="co"># (1) soil monolith (manually entered coordinates):</span></span></span>
<span class="r-in"><span><span class="va">imagename</span> <span class="op">=</span> <span class="st">"Soil_monolith.jpg"</span></span></span>
<span class="r-in"><span><span class="co"># import EXIF data using the Wikimedia API:</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="getWikimedia.html">getWikiMedia.ImageInfo</a></span><span class="op">(</span><span class="va">imagename</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in paste("https://commons.wikimedia.org/wiki/File:", imagename,     sep = ""):</span> object 'imagename' not found</span>
<span class="r-in"><span><span class="co"># create a SpatialPhotoOverlay:</span></span></span>
<span class="r-in"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu">spPhoto</span><span class="op">(</span>filename <span class="op">=</span> <span class="va">x1</span><span class="op">$</span><span class="va">url</span><span class="op">$</span><span class="va">url</span>, exif.info <span class="op">=</span> <span class="va">x1</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in file.exists(filename):</span> object 'x1' not found</span>
<span class="r-in"><span><span class="co"># plot it in Google Earth</span></span></span>
<span class="r-in"><span><span class="fu"><a href="kml.html">kml</a></span><span class="op">(</span><span class="va">sm</span>, method<span class="op">=</span><span class="st">"monolith"</span>, kmz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'obj' in selecting a method for function 'kml': object 'sm' not found</span>
<span class="r-in"><span><span class="co"># (2) PhotoOverlay (geotagged photo):</span></span></span>
<span class="r-in"><span><span class="va">imagename</span> <span class="op">=</span> <span class="st">"Africa_Museum_Nijmegen.jpg"</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="getWikimedia.html">getWikiMedia.ImageInfo</a></span><span class="op">(</span><span class="va">imagename</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">af</span> <span class="op">&lt;-</span> <span class="fu">spPhoto</span><span class="op">(</span>filename <span class="op">=</span> <span class="va">x2</span><span class="op">$</span><span class="va">url</span><span class="op">$</span><span class="va">url</span>, exif.info <span class="op">=</span> <span class="va">x2</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="kml.html">kml</a></span><span class="op">(</span><span class="va">af</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> KML file opened for writing...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Closing  af.kml</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomislav Hengl.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

